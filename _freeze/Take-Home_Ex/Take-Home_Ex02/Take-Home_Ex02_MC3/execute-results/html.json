{
  "hash": "e3bcad16d96ac113835bb3d0d836c107",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Assignment 2\"\ndescription: \"\"\nauthor: \"David Chiam\"\ndate: \"22 May 2025\"\ndate-modified: \"31 May 2025\"\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n# **Take Home Assignment 2 on Mini-Challenge 3**\n\n## **1 - Getting Started**\n\n### 1.1 - Load the R packages for this assignment\n\nFor the purpose of this assignment, five R packages will be used. They are tidyverse, jsonlite, tidygraph, ggraph and SmartEDA.\n\nIn the code chunk below, p_load() of pacman package is used to load the R packages into R environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, jsonlite, \n               tidygraph, ggraph, SmartEDA, \n               ggrepel, scales, lubridate, dplyr, viridis)\n```\n:::\n\n\n### 1.2 - Importing Knowledge Graph Data\n\nFor the purpose of this exercise, *mc3.json* file will be used. Before getting started, you should have the data set in the **data** sub-folder.\n\nIn the code chunk below, `fromJSON()` of **jsonlite** package is used to import *mc3.json* file into R and save the output object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMC3 <- fromJSON(\"data/MC3_graph.json\")\nMC3_schema <- fromJSON(\"data/MC3_schema.json\")\n```\n:::\n\n\n### 1.3 - **Data Overview**\n\nThe dataset was provided by VAST Challenge for MC3. This report utilizes two core datasets: MC3_graph.json, which encodes the knowledge graph of communications, events, and relationships; and MC3_schema.json, which defines the structure, subtypes, and attributes of each node and edge type within the graph. There ngraph contains a total of 1159 nodes and 3226 edges. Full description of node attributes and edge attributes is shown below.\n\n**Nodes Attributes** are as such:\n\n![Node Subtypes](Images/Node%20Attributes.png){fig-align=\"center\" width=\"600\"}\n\n**Edge Attributes** are as such:\n\n![Node-Edge-Node Matrix](Images/Edge%20Attributes.png){fig-align=\"center\" width=\"594\"}\n\n### 1.4 - **Inspecting knowledge graph structure**\n\nBefore preparing the data, it is always a good practice to examine the structure of *mc3* knowledge graph.\n\nIn the code chunk below `glimpse()` is used to reveal the structure of *mc3* knowledge graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(MC3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 5\n $ directed  : logi TRUE\n $ multigraph: logi FALSE\n $ graph     :List of 4\n  ..$ mode        : chr \"static\"\n  ..$ edge_default: Named list()\n  ..$ node_default: Named list()\n  ..$ name        : chr \"VAST_MC3_Knowledge_Graph\"\n $ nodes     :'data.frame':\t1159 obs. of  31 variables:\n  ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  ..$ findings         : chr [1:1159] NA NA NA NA ...\n  ..$ content          : chr [1:1159] NA NA NA NA ...\n  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  ..$ results          : chr [1:1159] NA NA NA NA ...\n  ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  ..$ destination      : chr [1:1159] NA NA NA NA ...\n  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  ..$ thing_collected  :'data.frame':\t1159 obs. of  2 variables:\n  .. ..$ type: chr [1:1159] NA NA NA NA ...\n  .. ..$ name: chr [1:1159] NA NA NA NA ...\n  ..$ reference        : chr [1:1159] NA NA NA NA ...\n  ..$ date             : chr [1:1159] NA NA NA NA ...\n  ..$ time             : chr [1:1159] NA NA NA NA ...\n  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  ..$ operational_role : chr [1:1159] NA NA NA NA ...\n $ edges     :'data.frame':\t3226 obs. of  5 variables:\n  ..$ id         : chr [1:3226] \"2\" \"3\" \"5\" \"3013\" ...\n  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  ..$ source     : chr [1:3226] \"Sam\" \"Sam\" \"Sam\" \"Sam\" ...\n  ..$ target     : chr [1:3226] \"Relationship_Suspicious_217\" \"Event_Communication_370\" \"Event_Assessment_600\" \"Relationship_Colleagues_430\" ...\n  ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n```\n\n\n:::\n:::\n\n\n::: callout-warning\nNotice that *Industry* field is in list data type. In general, this data type is not acceptable by `tbl_graph()` of **tidygraph**. In order to avoid error arise when building tidygraph object, it is wiser to exclude this field from the edges data table. However, it might be still useful in subsequent analysis.\n:::\n\n### 1.5 - Extract the edges and nodes tables\n\nNext, `as_tibble()` of **tibble** package package is used to extract the nodes and links tibble data frames from *mc3* tibble dataframe into two separate tibble dataframes called *mc3_nodes* and *mc3_edges* respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes <- as_tibble(MC3$nodes)\nmc3_edges <- as_tibble(MC3$edges)\n```\n:::\n\n\n### 1.6 - Brief Analyis of the extracted edges and nodes data (visuals)\n\nIt is time for us to apply appropriate EDA methods to examine the data.\n\n**Nodes:**\n\n:::: panel-tabset\nIn the code chunk below, `ExpCatViz()` of SmartEDA package is used to reveal the frequency distribution of all categorical fields in *mc3_nodes* tibble dataframe.\n\n### The Code Chunk\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_nodes,\n          col=\"lightblue\")\n```\n:::\n\n\n### The Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_nodes,\n          col=\"lightblue\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[2]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[3]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[4]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[5]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[6]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[7]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[8]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[9]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[10]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-10.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[11]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[12]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-12.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[13]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[14]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-6-14.png){width=672}\n:::\n:::\n\n\n::: callout-note\nWhat useful discovery can you obtained from the visualisation above?\n:::\n::::\n\n**Edges:**\n\n:::: panel-tabset\nOn the other hands, code chunk below uses `ExpCATViz()` of SmartEDA package to reveal the frequency distribution of all categorical fields in *mc3_edges* tibble dataframe.\n\n### The Code Chunk\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_edges,\n          col=\"lightblue\")\n```\n:::\n\n\n### The Plots\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\nWhat useful discovery can you obtained from the visualisation above?\n:::\n::::\n\n## 2 - **Data Cleaning and Wrangling**\n\n### **2.1 - Cleaning and wrangling nodes**\n\nCode chunk below performs the following data cleaning tasks:\n\n-   convert values in id field into character data type,\n-   exclude records with `id` value are na,\n-   exclude records with similar id values,\n-   exclude `thing_collected` field, and\n-   save the cleaned tibble dataframe into a new tibble datatable called `mc3_nodes_cleaned`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_cleaned <- mc3_nodes %>%\n  mutate(id = as.character(id)) %>%\n  filter(!is.na(id)) %>%\n  distinct(id, .keep_all = TRUE) %>%\n  select(-thing_collected)\n```\n:::\n\n\n### **2.2 - Cleaning and wrangling edges**\n\nNext, the code chunk below will be used to:\n\n-   rename source and target fields to from_id and to_id respectively,\n-   convert values in from_id and to_id fields to character data type,\n-   exclude values in from_id and to_id which not found in the id field of mc3_nodes_cleaned,\n-   exclude records whereby from_id and/or to_id values are missing, and\n-   save the cleaned tibble dataframe and called it mc3_edges_cleaned.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_cleaned <- mc3_edges %>%\n  rename(from_id = source, \n         to_id = target) %>%\n  mutate(across(c(from_id, to_id), \n                as.character)) %>%\n  filter(from_id %in% mc3_nodes_cleaned$id, \n         to_id %in% mc3_nodes_cleaned$id) %>%\n  filter(!is.na(from_id), !is.na(to_id))\n```\n:::\n\n\nNext, code chunk below will be used to create mapping of character id in `mc3_nodes_cleaned` to row index.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nnode_index_lookup <- mc3_nodes_cleaned %>%\n  mutate(.row_id = row_number()) %>%\n  select(id, .row_id)\n```\n:::\n\n\nNext, the code chunk below will be used to join and convert `from_id` and `to_id` to integer indices. At the same time we also drop rows with unmatched nodes.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_indexed <- mc3_edges_cleaned %>%\n  left_join(node_index_lookup, \n            by = c(\"from_id\" = \"id\")) %>%\n  rename(from = .row_id) %>%\n  left_join(node_index_lookup, \n            by = c(\"to_id\" = \"id\")) %>%\n  rename(to = .row_id) %>%\n  select(from, to, is_inferred, type) %>%\n  filter(!is.na(from) & !is.na(to))  \n```\n:::\n\n\nNext the code chunk below is used to subset nodes to only those referenced by edges.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nused_node_indices <- sort(\n  unique(c(mc3_edges_indexed$from, \n           mc3_edges_indexed$to)))\n\nmc3_nodes_final <- mc3_nodes_cleaned %>%\n  slice(used_node_indices) %>%\n  mutate(new_index = row_number())\n```\n:::\n\n\nWe will then use the code chunk below to rebuild lookup from old index to new index.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nold_to_new_index <- tibble(\n  old_index = used_node_indices,\n  new_index = seq_along(\n    used_node_indices))\n```\n:::\n\n\nLastly, the code chunk below will be used to update edge indices to match new node table.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_final <- mc3_edges_indexed %>%\n  left_join(old_to_new_index, \n            by = c(\"from\" = \"old_index\")) %>%\n  rename(from_new = new_index) %>%\n  left_join(old_to_new_index, \n            by = c(\"to\" = \"old_index\")) %>%\n  rename(to_new = new_index) %>%\n  select(from = from_new, to = to_new, \n         is_inferred, type)\n```\n:::\n\n\n### **2.3 - Building the tidygraph object**\n\nNow we are ready to build the tidygraph object by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_graph <- tbl_graph(\n  nodes = mc3_nodes_final,\n  edges = mc3_edges_final,\n  directed = TRUE\n)\n```\n:::\n\n\nAfter the tidygraph object is created, it is always a good practice to examine the object by using `str()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(mc3_graph)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'tbl_graph', 'igraph'  hidden list of 10\n $ : num 1159\n $ : logi TRUE\n $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...\n $ : num [1:3226] 1137 356 746 894 875 ...\n $ : NULL\n $ : NULL\n $ : NULL\n $ : NULL\n $ :List of 4\n  ..$ : num [1:3] 1 0 1\n  ..$ : Named list()\n  ..$ :List of 31\n  .. ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  .. ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  .. ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ findings         : chr [1:1159] NA NA NA NA ...\n  .. ..$ content          : chr [1:1159] NA NA NA NA ...\n  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ results          : chr [1:1159] NA NA NA NA ...\n  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  .. ..$ destination      : chr [1:1159] NA NA NA NA ...\n  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  .. ..$ reference        : chr [1:1159] NA NA NA NA ...\n  .. ..$ date             : chr [1:1159] NA NA NA NA ...\n  .. ..$ time             : chr [1:1159] NA NA NA NA ...\n  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...\n  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...\n  ..$ :List of 2\n  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  .. ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n $ :<environment: 0x00000213950a9690> \n - attr(*, \"active\")= chr \"nodes\"\n```\n\n\n:::\n:::\n\n\n## 3 - **Exploratory Data Analysis (after cleaning & wrangling)**\n\nSeveral of the **ggraph** layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1818)\n```\n:::\n\n\n### **3.1 - Visualising the knowledge graph**\n\nShows how many nodes are of type `Entity`, `Event`, or `Relationship`.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_final %>%\n  count(type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(type, -n), y = n, fill = type)) +\n  geom_col() +\n  geom_text(aes(label = n), vjust = -0.3) +\n  labs(title = \"Node Type Distribution\", x = \"Type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nIn the code chunk below, **ggraph** functions are used to create the whole graph.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggraph(mc3_graph, \n       layout = \"fr\") +\n  geom_edge_link(alpha = 0.3, \n                 colour = \"gray\") +\n  geom_node_point(aes(color = `type`), \n                  size = 4) +\n  geom_node_text(aes(label = type), \n                 repel = TRUE, \n                 size = 2.5) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n### **3.2 - Entity Sub_type Distribution**\n\nFocuses on what kinds of actors are in the graph — Person, Vessel, Organization, etc.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_final %>%\n  filter(type == \"Entity\") %>%\n  count(sub_type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(sub_type, n), y = n, fill = sub_type)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = n), hjust = -0.1) +\n  labs(title = \"Entity Sub-type Distribution\", x = \"Sub-type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n### **3.3 - Event Sub_type Distribution**\n\nTo understand what kinds of actions dominate — Communication, Monitoring, Assessment, etc.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_final %>%\n  filter(type == \"Event\") %>%\n  count(sub_type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(sub_type, n), y = n, fill = sub_type)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = n), hjust = -0.1) +\n  labs(title = \"Event Sub-type Distribution\", x = \"Sub-type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n### **3.4a - List of Communication Participants**\n\nThis finds all Entities that **sent or received** communication events — i.e., actors who participated in messaging.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(DT)\n\n# Step 1: Get all Communication Event IDs\ncomm_event_ids <- mc3_nodes_cleaned %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  pull(id)\n\n# Step 2: Extract 'sent' edges for communication events\ncomm_sent_edges <- mc3_edges_cleaned %>%\n  filter(type == \"sent\", to_id %in% comm_event_ids) %>%\n  select(comm_id = to_id, sender_id = from_id)\n\n# Step 3: Extract 'received' edges for same communication events\ncomm_received_edges <- mc3_edges_cleaned %>%\n  filter(type == \"received\", from_id %in% comm_event_ids) %>%\n  select(comm_id = from_id, receiver_id = to_id)\n\n# Step 4: Join sent and received edges by communication ID\ncomm_pairs <- comm_sent_edges %>%\n  inner_join(comm_received_edges, by = \"comm_id\")\n\n# Step 5: Add sender and receiver labels\nparticipants_named <- comm_pairs %>%\n  left_join(mc3_nodes_cleaned %>% select(id, sender_label = label), by = c(\"sender_id\" = \"id\")) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, receiver_label = label), by = c(\"receiver_id\" = \"id\"))\n\n\n\n# Step7: Interactive summary of top sender–receiver pairs\nparticipants_named %>%\n  count(sender_label, receiver_label, sort = TRUE) %>%\n  datatable(\n    caption = \"Top Communication Pairs (Sender → Receiver)\",\n    colnames = c(\"Sender\", \"Receiver\", \"Message Count\"),\n    options = list(pageLength = 10, autoWidth = TRUE),\n    rownames = FALSE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-54575bd3d30a622838bc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-54575bd3d30a622838bc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Top Communication Pairs (Sender → Receiver)<\\/caption>\",\"data\":[[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Sender<\\/th>\\n      <th>Receiver<\\/th>\\n      <th>Message Count<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"autoWidth\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"name\":\"sender_label\",\"targets\":0},{\"name\":\"receiver_label\",\"targets\":1},{\"name\":\"n\",\"targets\":2}],\"order\":[],\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### **3.4b - Network Visual of Communication Participants**\n\nThis code creates an **interactive communication network graph** using `visNetwork`, where:\n\n-   Each **node** represents a person or entity, **node size** is based on total messages **sent** by that participant.\n-   Each **edge (arrow)** represents a communication sent from one participant to another, the thicker the edge, the more message sent to that particular receiver.\n-   The layout places **larger (more active) nodes toward the center** in a circular arrangement.\n\n::: panel-tabset\n## Ver 1: Layout_in_circle\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(visNetwork)\n\n# Step 1: Summarize communication edges\ncomm_edges_vis <- participants_named %>%\n  count(sender_id, receiver_id, sort = TRUE) %>%\n  rename(from = sender_id, to = receiver_id, value = n)\n\n# Step 2: Compute messages sent per node\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare nodes, merge with message count and sort\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    sent_count = replace_na(sent_count, 0),\n    size = rescale(sent_count, to = c(10, 40)),  # larger = more active\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\"))\n  ) %>%\n  arrange(desc(size))  # Important: bigger nodes rendered first = inner in circle layout\n\n# Step 4: Format visNetwork edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Render network with layout_in_circle\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"1000px\") %>%\n  visNodes(size = nodes_vis$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_in_circle\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-a09acc36575f53e3d2b2\" style=\"width:100%;height:1000px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a09acc36575f53e3d2b2\">{\"x\":{\"nodes\":{\"id\":[\"Green Guardians\",\"Oceanus City Council\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"The Lookout\",\"Himark Harbor\",\"Davis\",\"Remora\",\"The Intern\",\"Clepper Jensen\",\"Mrs. Money\",\"Miranda Jordan\",\"Sentinel\",\"Paackland Harbor\",\"V. Miesel Shipping\",\"Rodriguez\",\"Horizon\",\"EcoVigil\",\"The Middleman\",\"Liam Thorne\",\"Samantha Blake\",\"Boss\",\"Nadia Conti\",\"Serenity\",\"Small Fry\",\"Marlin\",\"Haacklee Harbor\",\"Osprey\",\"Elise\",\"Defender\",\"Glitters Team\",\"Northern Light\",\"Knowles\",\"The Accountant\",\"Seawatch\",\"Kelly\",\"Sailor Shifts Team\",\"Sam\",\"City Officials\",\"Port Security\"],\"label\":[\"Green Guardians\",\"Oceanus City Council\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"The Lookout\",\"Himark Harbor\",\"Davis\",\"Remora\",\"The Intern\",\"Clepper Jensen\",\"Mrs. Money\",\"Miranda Jordan\",\"Sentinel\",\"Paackland Harbor\",\"V. Miesel Shipping\",\"Rodriguez\",\"Horizon\",\"EcoVigil\",\"The Middleman\",\"Liam Thorne\",\"Samantha Blake\",\"Boss\",\"Nadia Conti\",\"Serenity\",\"Small Fry\",\"Marlin\",\"Haacklee Harbor\",\"Osprey\",\"Elise\",\"Defender\",\"Glitters Team\",\"Northern Light\",\"Knowles\",\"The Accountant\",\"Seawatch\",\"Kelly\",\"Sailor Shifts Team\",\"Sam\",\"City Officials\",\"Port Security\"],\"sub_type\":[\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Person\",\"Location\",\"Person\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Location\",\"Organization\",\"Person\",\"Vessel\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Person\",\"Vessel\",\"Location\",\"Vessel\",\"Person\",\"Vessel\",\"Organization\",\"Vessel\",\"Vessel\",\"Person\",\"Vessel\",\"Person\",\"Organization\",\"Person\",\"Group\",\"Location\"],\"sent_count\":[44,37,35,34,34,33,27,25,25,24,20,19,18,18,16,15,14,14,14,13,11,9,9,8,8,7,7,7,6,5,5,4,4,4,3,3,2,2,1,0,0],\"size\":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],\"title\":[\"Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages\",\"Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 35 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 33 messages\",\"Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages\",\"Davis<br>Sub-type: Person<br>Sent: 25 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 25 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 24 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages\",\"V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 14 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 14 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 13 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages\",\"Boss<br>Sub-type: Person<br>Sent: 9 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 8 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 7 messages\",\"Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Elise<br>Sub-type: Person<br>Sent: 5 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages\",\"Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 4 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages\",\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"City Officials<br>Sub-type: Group<br>Sent: 0 messages\",\"Port Security<br>Sub-type: Location<br>Sent: 0 messages\"],\"x\":[1,0.988263204734962,0.9533279194732136,0.8960129976915159,0.8176618525785562,0.7201109685684317,0.6056468557020445,0.4769524557696989,0.3370442564294944,0.189201587293274,0.03688975521995497,-0.1163211795401867,-0.2668400825319395,-0.4111389182430832,-0.5458354442665709,-0.6677724881958929,-0.7740919490703919,-0.8623017888393665,-0.9303344436218247,-0.9765952856514705,-1,-1,-0.9765952856514704,-0.9303344436218246,-0.8623017888393664,-0.7740919490703918,-0.6677724881958926,-0.5458354442665705,-0.4111389182430827,-0.2668400825319392,-0.1163211795401862,0.03688975521995497,0.1892015872932742,0.3370442564294949,0.4769524557696991,0.6056468557020447,0.7201109685684317,0.8176618525785562,0.8960129976915159,0.9533279194732136,0.988263204734962],\"y\":[0,0.1527613834167303,0.3019421694807169,0.4440456870063911,0.5757411499843077,0.6939417283821623,0.7958769008244742,0.8791573932654411,0.9418311815475191,0.9824292451932162,1,0.9941316023674809,0.964961602562342,0.9131737206566701,0.8399818207089611,0.7471014588194116,0.6367096719489684,0.5113939500181348,0.3740915873362889,0.2280208349126063,0.07660546738007068,-0.07660546738007079,-0.2280208349126069,-0.374091587336289,-0.511393950018135,-0.6367096719489687,-0.7471014588194118,-0.8399818207089614,-0.9131737206566706,-0.964961602562342,-0.994131602367481,-1,-0.9824292451932162,-0.941831181547519,-0.879157393265441,-0.7958769008244738,-0.6939417283821623,-0.5757411499843074,-0.4440456870063906,-0.3019421694807168,-0.1527613834167298]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],\"value\":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 12\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":1818}},\"groups\":null,\"width\":\"100%\",\"height\":\"1000px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Ver 2: Layout_on_sphere\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(visNetwork)\n\n# Step 1: Summarize communication edges\ncomm_edges_vis <- participants_named %>%\n  count(sender_id, receiver_id, sort = TRUE) %>%\n  rename(from = sender_id, to = receiver_id, value = n)\n\n# Step 2: Compute messages sent per person (by sender)\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare nodes with label, subtype, and scaled size\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    size = if_else(\n      sub_type == \"Person\",\n      rescale(sent_count, to = c(10, 40), na.rm = TRUE),\n      15  # default size for other node types\n    ),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\"))\n  )\n\n# Step 4: Format edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Render the network with layout_on_sphere\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"900px\") %>%\n  visNodes(size = nodes_vis$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_on_sphere\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 42)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-175c971dccb8e6d83228\" style=\"width:100%;height:900px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-175c971dccb8e6d83228\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\",\"Location\",\"Location\",\"Location\",\"Location\"],\"sent_count\":[1,2,8,5,11,9,25,14,20,18,24,33,3,19,13,9,7,4,37,44,15,2,34,7,8,35,34,14,3,14,18,6,5,4,25,4,null,16,7,27,null],\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages\",\"Elise<br>Sub-type: Person<br>Sent: 5 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages\",\"Davis<br>Sub-type: Person<br>Sent: 25 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 14 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 24 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 33 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 13 messages\",\"Boss<br>Sub-type: Person<br>Sent: 9 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages\",\"Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages\",\"Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages\",\"V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages\",\"Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 7 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 8 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 35 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 25 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 4 messages\",\"City Officials<br>Sub-type: Group\",\"Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages\",\"Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages\",\"Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages\",\"Port Security<br>Sub-type: Location\"],\"x\":[0.006440927175621391,-0.06664830184967618,-0.4409630997074512,-0.2787167727474305,0.2365064772775034,0.6476746072078645,0.667719144831592,0.2976986554858154,-0.2526935027451958,-0.7129586264042103,-0.8813060495281457,-0.6944798975090127,-0.2316698995019175,0.3317086862019816,0.794708147038439,1,0.8814846985123932,0.4796721568472757,-0.0759052165537506,-0.6094787616592352,-0.9536054047189444,-1,-0.732695736478211,-0.2342851279815245,0.3371692344569699,0.7953258761289943,0.9847209772943193,0.83512595572909,0.393361353839724,-0.1815498231890834,-0.6654615755328198,-0.851148143779292,-0.642764389284291,-0.1259267219792909,0.4310925572677355,0.6825812698064202,0.4211383409771228,-0.1688497446265791,-0.4410178911458582,0.09467015775055376,0.006440927175621391],\"y\":[-0.01598891125852964,0.2954839704434384,0.006862204298155872,-0.4747234670075287,-0.5862691145784071,-0.2409750687836689,0.3014469779380633,0.7063569373476082,0.7617907495947651,0.4507146812594094,-0.08001565513005549,-0.6066112860066712,-0.924405409326406,-0.9192001757418308,-0.5970787360481746,-0.07163254829246113,0.4807357855851913,0.8803103056319443,1,0.8025079340453891,0.3497092889073024,-0.2171529858949235,-0.7203891044614957,-1,-0.9640461487628595,-0.620602608247057,-0.08055603018195756,0.4725053352879633,0.8400550256881181,0.8794642891354818,0.5658741880942779,0.02003717536535121,-0.5188955272797955,-0.7832295634598994,-0.6126999832464018,-0.08620961161376928,0.4389235777464779,0.4945974391681667,-0.03774803939227411,-0.3235418088732364,-0.01598891125852964]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],\"value\":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 12\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":42}},\"groups\":null,\"width\":\"100%\",\"height\":\"900px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n:::\n\n## 4 - Task 1: Daily Temporal Patterns in Communication 🎯\n\n**Objective**\n\n1.  Identify **when** communications happen most often during each day.\n2.  Detect **shifts in these patterns** over the 2-week period.\n3.  Later: Focus on a **specific entity** (e.g., Nadia Conti) and explore **who influences them**.\n\n### Step 1: Extract & Parse Communication Event Timestamps\n\nExtract the Communication Timestamps from `mc3_nodes_final` and filter for communication events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for Communication events\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    day = as.Date(timestamp),\n    hour = hour(timestamp)\n  )\n```\n:::\n\n\nParse the Communication Timestamp into the format \"dd/mm/yyy (ddd)\" for ease of reference.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Communication events with parsed date and time\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    hour = hour(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")  # e.g., \"19/03/2040 (Tue)\"\n  )\n```\n:::\n\n\n### Step 2: Visualize the Communication Volume for Analysis \n\n#### **6.1 - Bar Plot of daily communication volume over the 2 weeks period:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Step 1: Prepare daily message volume data\ndaily_message_volume <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    date = as.Date(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")\n  ) %>%\n  group_by(date, date_label) %>%\n  summarise(message_count = n(), .groups = \"drop\") %>%\n  arrange(date)\n\n# Step 2: Compute average and total message count\navg_msg_count <- mean(daily_message_volume$message_count)\ntotal_msg_count <- sum(daily_message_volume$message_count)\n\n# Step 3: Plot bar chart with average + total labels\nggplot(daily_message_volume, aes(x = date_label, y = message_count)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text(\n    aes(label = message_count),\n    vjust = -0.3,\n    size = 2.5,\n    color = \"grey40\"\n  ) +\n  geom_hline(yintercept = avg_msg_count, color = \"red\", linetype = \"dashed\", size = 1.2) +\n  annotate(\n    \"label\", x = 1, y = avg_msg_count + 2,\n    label = paste(\"Average =\", round(avg_msg_count, 1)),\n    color = \"red\", fill = \"grey90\",\n    label.size = 0, hjust = -0.2, vjust = 3\n  ) +\n  annotate(\n    \"label\", x = nrow(daily_message_volume), y = max(daily_message_volume$message_count) + 5,\n    label = paste(\"Total =\", total_msg_count),\n    color = \"black\", fill = \"lightgrey\",\n    label.size = 0.3, hjust = 1.1, vjust = 1\n  ) +\n  labs(\n    title = \"Daily Radio Communication Volume\",\n    x = \"Date\",\n    y = \"Message Count\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n#### **6.2 - Interactive Table of daily communication volume variation(message count)** \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(DT)\n\n# Daily message volume with comparisons\ndaily_message_volume <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    date = as.Date(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")\n  ) %>%\n  group_by(date, date_label) %>%\n  summarise(message_count = n(), .groups = \"drop\") %>%\n  arrange(date) %>%\n  mutate(\n    change_from_prev = message_count - lag(message_count),\n    pct_change_from_prev = round((message_count - lag(message_count)) / lag(message_count) * 100, 2)\n  )\n\ndatatable(\n  daily_message_volume %>% select(-date),  # remove raw date if not needed\n  caption = \"Daily Message Volume with Day-over-Day Change\",\n  options = list(pageLength = 14, order = list(list(0, 'asc'))),\n  rownames = FALSE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-08444c9e699161510b2c\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-08444c9e699161510b2c\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Daily Message Volume with Day-over-Day Change<\\/caption>\",\"data\":[[\"01/10/2040 (Mon)\",\"02/10/2040 (Tue)\",\"03/10/2040 (Wed)\",\"04/10/2040 (Thu)\",\"05/10/2040 (Fri)\",\"06/10/2040 (Sat)\",\"07/10/2040 (Sun)\",\"08/10/2040 (Mon)\",\"09/10/2040 (Tue)\",\"10/10/2040 (Wed)\",\"11/10/2040 (Thu)\",\"12/10/2040 (Fri)\",\"13/10/2040 (Sat)\",\"14/10/2040 (Sun)\"],[44,46,46,40,45,38,42,43,35,34,49,43,42,37],[null,2,0,-6,5,-7,4,1,-8,-1,15,-6,-1,-5],[null,4.55,0,-13.04,12.5,-15.56,10.53,2.38,-18.6,-2.86,44.12,-12.24,-2.33,-11.9]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>date_label<\\/th>\\n      <th>message_count<\\/th>\\n      <th>change_from_prev<\\/th>\\n      <th>pct_change_from_prev<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":14,\"order\":[[0,\"asc\"]],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3]},{\"name\":\"date_label\",\"targets\":0},{\"name\":\"message_count\",\"targets\":1},{\"name\":\"change_from_prev\",\"targets\":2},{\"name\":\"pct_change_from_prev\",\"targets\":3}],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,14,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n#### **6.3 - Heat Map of hourly message volume for each day over the 2 weeks period:** \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(forcats)\n\n# Ensure timestamp and extract hour + formatted date\ncomm_heatmap <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    hour = hour(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")\n  ) %>%\n  group_by(date_label, hour) %>%\n  summarise(count = n(), .groups = \"drop\")\n\n\nggplot(comm_heatmap, aes(x = hour, y = fct_rev(factor(date_label)), fill = count)) +\n  geom_tile(color = \"white\") +\n  scale_fill_viridis_c(\n    option = \"inferno\",       # or try \"plasma\" or \"magma\"\n    direction = -1,           # reverses the color scale\n    name = \"Message Count\"\n  ) +\n  scale_x_continuous(\n    breaks = 0:23,\n    labels = function(x) sprintf(\"%02d:00\", x)\n  ) +\n  labs(\n    title = \"Hourly Heatmap of Radio Communications by Day\",\n    x = \"Hour of Day\",\n    y = \"Date\"\n  ) +\n  theme_minimal(base_size = 10) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\"),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n#### **6.4 - Heat Map of half-hourly message volume for each day over the 2 weeks period:** \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(forcats)\n\n# Prepare half-hour bin\ncomm_heatmap <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\"),\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = hour + ifelse(minute < 30, 0, 0.5)\n  ) %>%\n  group_by(date_label, time_bin) %>%\n  summarise(count = n(), .groups = \"drop\")\n\n\nggplot(comm_heatmap, aes(x = time_bin, y = fct_rev(factor(date_label)), fill = count)) +\n  geom_tile(color = \"white\") +\n  scale_fill_viridis_c(\n    option = \"inferno\",       # or try \"plasma\" or \"magma\"\n    direction = -1,           # reverses the color scale\n    name = \"Message Count\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  labs(\n    title = \"Half-Hourly Heatmap of Radio Communications by Day\",\n    x = \"Time of Day\",\n    y = \"Date\"\n  ) +\n  theme_minimal(base_size = 10) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\"),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n### Step 3: Plot Combined Hourly and Half-hourly Communication Volume \n\n**Bar Plot of combined hourly message volume over the 2 weeks period:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Prepare data\ncomm_hourly <- comm_events %>%\n  count(hour) %>%\n  mutate(\n    hour_label = sprintf(\"%02d:00\", hour),  # Format to hh:mm\n    percent = n / sum(n)\n  )\n\n# Plot\nggplot(comm_hourly, aes(x = hour_label, y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text_repel(\n    aes(label = paste0(n, \" (\", percent(percent, accuracy = 1), \")\")),\n    nudge_y = 3,\n    size = 2.5,\n    direction = \"y\",\n    max.overlaps = Inf\n  ) +\n  labs(\n    title = \"Overall Hourly Communication Volume\",\n    x = \"Time of Day (hh:mm)\",\n    y = \"Message Count\"\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n**Bar Plot of combined half-hourly message volume in the 2 weeks period.**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = sprintf(\"%02d:%02d\", hour, ifelse(minute < 30, 0, 30))\n  )\n\ncomm_halfhour <- comm_events %>%\n  count(time_bin) %>%\n  mutate(percent = n / sum(n))\n\nggplot(comm_halfhour, aes(x = time_bin, y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text_repel(\n    aes(label = paste0(n, \" (\", percent(percent, accuracy = 1), \")\")),\n    nudge_y = 3,\n    size = 2,\n    direction = \"y\",\n    max.overlaps = Inf\n  ) +\n  labs(\n    title = \"Overall Half-Hourly Communication Volume\",\n    x = \"Time of Day (hh:mm)\",\n    y = \"Message Count\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n### Step 2c: Plot a Daily Facet Graph (Heatmap / Bar)\n\nStep 2c: Faceted Daily Graphs (One Plot per Day)\n\n```         \n```\n\n## Unused Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\"),\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = hour + ifelse(minute < 30, 0, 0.5)\n  )\n\nggplot(comm_events, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  facet_wrap(~ date_label, ncol = 4) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  labs(\n    title = \"Daily Communication Patterns (Half-Hourly)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(visNetwork)\n\n# Step 1: Summarize communication edges\ncomm_edges_vis <- participants_named %>%\n  count(sender_id, receiver_id, sort = TRUE) %>%\n  rename(from = sender_id, to = receiver_id, value = n)\n\n# Step 2: Compute messages sent per person (by sender)\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare nodes with label, subtype, and scaled size\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    size = if_else(\n      sub_type == \"Person\",\n      rescale(sent_count, to = c(10, 40), na.rm = TRUE),\n      15  # default size for other node types\n    ),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\"))\n  )\n\n# Step 4: Format edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Render the network with layout_on_sphere\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"900px\") %>%\n  visNodes(size = nodes_vis$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_on_sphere\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 42)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-7f489343c35a3911d555\" style=\"width:100%;height:900px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7f489343c35a3911d555\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\",\"Location\",\"Location\",\"Location\",\"Location\"],\"sent_count\":[1,2,8,5,11,9,25,14,20,18,24,33,3,19,13,9,7,4,37,44,15,2,34,7,8,35,34,14,3,14,18,6,5,4,25,4,null,16,7,27,null],\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages\",\"Elise<br>Sub-type: Person<br>Sent: 5 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages\",\"Davis<br>Sub-type: Person<br>Sent: 25 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 14 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 24 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 33 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 13 messages\",\"Boss<br>Sub-type: Person<br>Sent: 9 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages\",\"Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages\",\"Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages\",\"V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages\",\"Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 7 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 8 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 35 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 25 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 4 messages\",\"City Officials<br>Sub-type: Group\",\"Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages\",\"Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages\",\"Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages\",\"Port Security<br>Sub-type: Location\"],\"x\":[0.006440927175621391,-0.06664830184967618,-0.4409630997074512,-0.2787167727474305,0.2365064772775034,0.6476746072078645,0.667719144831592,0.2976986554858154,-0.2526935027451958,-0.7129586264042103,-0.8813060495281457,-0.6944798975090127,-0.2316698995019175,0.3317086862019816,0.794708147038439,1,0.8814846985123932,0.4796721568472757,-0.0759052165537506,-0.6094787616592352,-0.9536054047189444,-1,-0.732695736478211,-0.2342851279815245,0.3371692344569699,0.7953258761289943,0.9847209772943193,0.83512595572909,0.393361353839724,-0.1815498231890834,-0.6654615755328198,-0.851148143779292,-0.642764389284291,-0.1259267219792909,0.4310925572677355,0.6825812698064202,0.4211383409771228,-0.1688497446265791,-0.4410178911458582,0.09467015775055376,0.006440927175621391],\"y\":[-0.01598891125852964,0.2954839704434384,0.006862204298155872,-0.4747234670075287,-0.5862691145784071,-0.2409750687836689,0.3014469779380633,0.7063569373476082,0.7617907495947651,0.4507146812594094,-0.08001565513005549,-0.6066112860066712,-0.924405409326406,-0.9192001757418308,-0.5970787360481746,-0.07163254829246113,0.4807357855851913,0.8803103056319443,1,0.8025079340453891,0.3497092889073024,-0.2171529858949235,-0.7203891044614957,-1,-0.9640461487628595,-0.620602608247057,-0.08055603018195756,0.4725053352879633,0.8400550256881181,0.8794642891354818,0.5658741880942779,0.02003717536535121,-0.5188955272797955,-0.7832295634598994,-0.6126999832464018,-0.08620961161376928,0.4389235777464779,0.4945974391681667,-0.03774803939227411,-0.3235418088732364,-0.01598891125852964]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],\"value\":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 12\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":42}},\"groups\":null,\"width\":\"100%\",\"height\":\"900px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n",
    "supporting": [
      "Take-Home_Ex02_MC3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}